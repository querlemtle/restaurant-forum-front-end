(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(s,t,e){"use strict";e.r(t);var r=function(){var s=this,t=s._self._c;return t("div",{staticClass:"album py-5 bg-light"},[t("div",{staticClass:"container"},[s.isLoading?t("Spinner"):[t("div",{staticClass:"card mb-3"},[t("UserProfileCard",{attrs:{"initial-user":s.user,"initial-is-followed":s.isFollowed}})],1),t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4"},[t("UserFollowingsCard",{attrs:{"user-followings":s.userFollowings}}),t("br"),t("UserFollowersCard",{attrs:{"user-followers":s.userFollowers}})],1),t("div",{staticClass:"col-md-8"},[t("UserCommentsCard",{attrs:{"user-comments":s.userComments}}),t("br"),t("UserFavoritedRestaurantsCard",{attrs:{"user-favorited-restaurants":s.userFavoritedRestaurants}})],1)])]],2)])},i=[],a=(e("d9e2"),function(){var s=this,t=s._self._c;return t("div",{staticClass:"row no-gutters"},[t("div",{staticClass:"col-md-4"},[t("img",{attrs:{src:s._f("emptyImage")(s.user.image),width:"300px",height:"300px"}})]),t("div",{staticClass:"col-md-8"},[t("div",{staticClass:"card-body"},[t("h5",{staticClass:"card-title"},[s._v(" "+s._s(s.user.name)+" ")]),t("p",{staticClass:"card-text"},[s._v(" "+s._s(s.user.email)+" ")]),t("ul",{staticClass:"list-unstyled list-inline"},[t("li",[t("strong",[s._v(s._s(s.user.commentsLength))]),s._v(" 已評論餐廳")]),t("li",[t("strong",[s._v(s._s(s.user.favoritedRestaurantsLength))]),s._v(" 收藏的餐廳")]),t("li",[t("strong",[s._v(s._s(s.user.followingsLength))]),s._v(" followings (追蹤者)")]),t("li",[t("strong",[s._v(s._s(s.user.followersLength))]),s._v(" followers (追隨者)")])]),t("p"),t("form",{staticStyle:{display:"contents"},attrs:{action:"/following/1?_method=DELETE",method:"POST"}},[s.currentUser.id===s.user.id?[t("router-link",{attrs:{to:{name:"user-edit",params:{id:s.user.id}}}},[t("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[s._v(" Edit ")])])]:[s.isFollowed?t("button",{staticClass:"btn btn-danger",attrs:{type:"submit",disabled:s.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),s.deleteFollowing(s.user.id)}}},[s._v(" 取消追蹤 ")]):t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:s.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),s.addFollowing(s.user.id)}}},[s._v(" 追蹤 ")])]],2),t("p")])])])}),o=[],l=e("2708"),n=e("4cce"),d=e("2fa3"),u=e("2f62"),c={name:"UserProfileCard",mixins:[l["a"]],props:{initialUser:{type:Object,required:!0},initialIsFollowed:{type:Boolean,required:!0}},data(){return{user:this.initialUser,isFollowed:this.initialIsFollowed,isProcessing:!1}},computed:{...Object(u["b"])(["currentUser"])},watch:{initialUser(s){this.user={...this.user,...s}},initialIsFollowed(s){this.isFollowed=s}},methods:{async addFollowing(s){try{this.isProcessing=!0;const{data:t}=await n["a"].addFollowing({userId:s});if("error"===t.status)throw new Error(t.message);this.isFollowed=!0,this.isProcessing=!1}catch(t){this.isProcessing=!1,console.error(t.message),d["a"].fire({icon:"error",title:"無法加入追蹤使用者，請稍後再試"})}},async deleteFollowing(s){try{this.isProcessing=!0;const{data:t}=await n["a"].deleteFollowing({userId:s});if("error"===t.status)throw new Error(t.message);this.isFollowed=!1,this.isProcessing=!1}catch(t){this.isProcessing=!1,console.error(t.message),d["a"].fire({icon:"error",title:"無法取消追蹤使用者，請稍後再試"})}}}},m=c,g=e("2877"),h=Object(g["a"])(m,a,o,!1,null,null,null),w=h.exports,v=function(){var s=this,t=s._self._c;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[s._v(s._s(s.userFollowings.length))]),s._v(" followings (追蹤者) ")]),t("div",{staticClass:"card-body"},s._l(s.userFollowings,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{staticClass:"mr-1",attrs:{src:s._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},p=[],f={name:"UserFollowingsCard",mixins:[l["a"]],props:{userFollowings:{type:Array,required:!0}}},C=f,_=Object(g["a"])(C,v,p,!1,null,null,null),F=_.exports,b=function(){var s=this,t=s._self._c;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[s._v(s._s(s.userFollowers.length))]),s._v(" followers (追隨者) ")]),t("div",{staticClass:"card-body"},s._l(s.userFollowers,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{staticClass:"mr-1",attrs:{src:s._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},y=[],U={name:"UserFollowersCard",mixins:[l["a"]],props:{userFollowers:{type:Array,required:!0}}},L=U,P=Object(g["a"])(L,b,y,!1,null,null,null),R=P.exports,k=function(){var s=this,t=s._self._c;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[s._v(s._s(s.userComments.length))]),s._v(" 已評論餐廳")]),t("div",{staticClass:"card-body"},s._l(s.userComments,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.id}}}},[t("img",{staticClass:"mr-1",attrs:{src:s._f("emptyImage")(e.Restaurant.image),width:"60",height:"60"}})])})),1)])},x=[],I={name:"UserCommentsCard",mixins:[l["a"]],props:{userComments:{type:Array,required:!0}}},O=I,j=Object(g["a"])(O,k,x,!1,null,null,null),E=j.exports,q=function(){var s=this,t=s._self._c;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[s._v(s._s(s.userFavoritedRestaurants.length))]),s._v(" 收藏的餐廳")]),t("div",{staticClass:"card-body"},s._l(s.userFavoritedRestaurants,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.id}}}},[t("img",{staticClass:"mr-1",attrs:{src:s._f("emptyImage")(e.image),width:"60",height:"60"}})])})),1)])},A=[],S={name:"UserFavoritedRestaurantsCard",mixins:[l["a"]],props:{userFavoritedRestaurants:{type:Array,required:!0}}},D=S,J=Object(g["a"])(D,q,A,!1,null,null,null),T=J.exports,B=e("2375"),$={name:"User",components:{UserProfileCard:w,UserFollowingsCard:F,UserFollowersCard:R,UserCommentsCard:E,UserFavoritedRestaurantsCard:T,Spinner:B["a"]},data(){return{user:{id:-1,name:"",email:"",image:"",followingsLength:0,followersLength:0,commentsLength:0,favoritedRestaurantsLength:0},userFollowings:[],userFollowers:[],userComments:[],userFavoritedRestaurants:[],isFollowed:!1,isLoading:!0}},computed:{...Object(u["b"])(["currentUser"])},created(){const{id:s}=this.$route.params;this.fetchUser(s)},beforeRouteUpdate(s,t,e){const{id:r}=s.params;this.fetchUser(r),e()},methods:{async fetchUser(s){try{const{data:t}=await n["a"].get({userId:s});if("error"===t.status)throw new Error(t.message);const{profile:e,isFollowed:r}=t,{id:i,name:a,email:o,image:l,Comments:d,FavoritedRestaurants:u,Followers:c,Followings:m}=e;this.user={...this.user,id:i,name:a,email:o,image:l,followingsLength:m.length,followersLength:c.length,commentsLength:d.length,favoritedRestaurantsLength:u.length},this.userFollowings=m,this.userFollowers=c,this.userComments=d,this.userFavoritedRestaurants=u,this.isFollowed=r,this.isLoading=!1}catch(t){this.isLoading=!1,console.error(t.message),d["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}}}},z=$,G=Object(g["a"])(z,r,i,!1,null,null,null);t["default"]=G.exports}}]);
//# sourceMappingURL=chunk-2d0ab43a.0f6f948a.js.map